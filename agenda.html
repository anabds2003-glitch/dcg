<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Agenda</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <button id="toggleTheme" type="button" aria-label="Changer le th√®me">üåô</button>

  <header>
    <div class="header-top">
      <h1>Agenda</h1>
    </div>
    <nav>
      <ul class="menu">
        <li><a href="index.html">Accueil</a></li>
        <li><a href="agenda.html" class="active">Agenda</a></li>
        <li><a href="matieres.html">Mati√®res</a></li>
        <li><a href="liens.html">Liens</a></li>
        <li><a href="question.html">Question</a></li>
        <li><a href="contact.html">Contact</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <div class="form-card">
      <h2>Mon agenda</h2>
      <p>Voici les dates importantes du semestre √† retenir pour ton ann√©e de DCG.</p>

      <ul>
        <li>üìÖ Rentr√©e : 2 septembre 2025</li>
        <li>üìù Examens blancs : 18‚Äì22 novembre 2025</li>
        <li>üéÑ Vacances de No√´l : 21 d√©cembre au 5 janvier</li>
        <li>üìö Examens DCG : juin 2026</li>
      </ul>

      <h3>Calendrier interactif</h3>
      <div class="calendar-container">
        <div class="calendar-header">
          <button id="prevMonth">‚Üê</button>
          <h4 id="monthYear"></h4>
          <button id="nextMonth">‚Üí</button>
        </div>
        <table class="calendar">
          <thead>
            <tr>
              <th>Lu</th><th>Ma</th><th>Me</th><th>Je</th><th>Ve</th><th>Sa</th><th>Di</th>
            </tr>
          </thead>
          <tbody id="calendarBody"></tbody>
        </table>
      </div>

      <div class="event-form">
        <h4>Ajouter un √©v√©nement</h4>
        <form id="addEventForm">
          <input type="text" id="eventTitle" placeholder="Titre de l'√©v√©nement" required />
          <input type="date" id="eventDate" required />
          <button type="submit">Ajouter</button>
        </form>
      </div>

      <div class="back-button">
        <a href="index.html" class="btn-retour">‚Üê Retour √† l‚Äôaccueil</a>
      </div>
    </div>
  </main>

  <footer>
    <p>&copy; 2025 - Mon Espace √âtudiant</p>
  </footer>

  <script src="theme.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const toggleThemeButton = document.getElementById("toggleTheme");

      function applyTheme(isDark) {
        document.body.classList.toggle("dark-mode", isDark);
        toggleThemeButton.textContent = isDark ? "‚òÄÔ∏è" : "üåô";
      }

      const savedTheme = localStorage.getItem("theme");
      const isDarkSaved = savedTheme === "dark";
      applyTheme(isDarkSaved);

      toggleThemeButton.addEventListener("click", () => {
        const isDark = !document.body.classList.contains("dark-mode");
        applyTheme(isDark);
        localStorage.setItem("theme", isDark ? "dark" : "light");
      });

      const monthYear = document.getElementById("monthYear");
      const calendarBody = document.getElementById("calendarBody");
      const prevMonth = document.getElementById("prevMonth");
      const nextMonth = document.getElementById("nextMonth");
      const eventForm = document.getElementById("addEventForm");
      const eventTitle = document.getElementById("eventTitle");
      const eventDate = document.getElementById("eventDate");

      let currentDate = new Date(2025, 8); // Septembre 2025
      let events = JSON.parse(localStorage.getItem("calendarEvents")) || [];

      function saveEvents() {
        localStorage.setItem("calendarEvents", JSON.stringify(events));
      }

      function renderCalendar(date) {
        const year = date.getFullYear();
        const month = date.getMonth();
        const firstDay = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();
        const monthNames = ["Janvier","F√©vrier","Mars","Avril","Mai","Juin","Juillet","Ao√ªt","Septembre","Octobre","Novembre","D√©cembre"];
        monthYear.textContent = `${monthNames[month]} ${year}`;

        calendarBody.innerHTML = "";
        let row = document.createElement("tr");
        let dayIndex = (firstDay + 6) % 7;

        for (let i = 0; i < dayIndex; i++) {
          row.appendChild(document.createElement("td"));
        }

        for (let day = 1; day <= daysInMonth; day++) {
          if (dayIndex % 7 === 0) {
            calendarBody.appendChild(row);
            row = document.createElement("tr");
          }

          const cell = document.createElement("td");
          const cellDate = new Date(year, month, day).toISOString().split("T")[0];
          cell.innerHTML = `<div class="day-number">${day}</div>`;

          const dayEvents = events.filter(ev => ev.date === cellDate);
          dayEvents.forEach((ev, index) => {
            const evEl = document.createElement("div");
            evEl.className = "event-badge";
            evEl.textContent = ev.title;
            evEl.title = "Clique pour modifier ou supprimer";
            evEl.style.cursor = "pointer";
            evEl.addEventListener("click", () => {
              const action = prompt(`Modifier ou supprimer l'√©v√©nement : "${ev.title}"\n\n- Pour modifier, entre un nouveau titre\n- Pour supprimer, laisse vide et clique OK`);
              if (action === null) return;
              if (action.trim() === "") {
                events.splice(events.indexOf(ev), 1);
              } else {
                events[index].title = action.trim();
              }
              saveEvents();
              renderCalendar(currentDate);
            });
            cell.appendChild(evEl);
          });

          row.appendChild(cell);
          dayIndex++;
        }

        calendarBody.appendChild(row);
      }

      eventForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const title = eventTitle.value.trim();
        const date = eventDate.value;
        if (title && date) {
          events.push({ title, date });
          saveEvents();
          eventTitle.value = "";
          eventDate.value = "";
          renderCalendar(currentDate);
        }
      });

      prevMonth.addEventListener("click", () => {
        if (currentDate.getFullYear() > 2025 || currentDate.getMonth() > 8) {
          currentDate.setMonth(currentDate.getMonth() - 1);
          renderCalendar(currentDate);
        }
      });

      nextMonth.addEventListener("click", () => {
        if (currentDate.getFullYear() < 2026 || currentDate.getMonth() < 7) {
          currentDate.setMonth(currentDate.getMonth() + 1);
          renderCalendar(currentDate);
        }
      });

      renderCalendar(currentDate);
    });
  </script>
</body>
</html>
